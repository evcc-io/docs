---
title: Viessmann Heatpump (SG Ready)
custom_edit_url: https://github.com/evcc-io/evcc/blob/master/templates/definition/charger/viessmann.yaml
hide_table_of_contents: true
---

import DeviceConfig from '@site/src/components/DeviceConfig';
import DeviceFeatures from '@site/src/components/DeviceFeatures';
import SponsorshipRequired from '/docs/_sponsorship_required.mdx';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import '@evcc/icons';

# Viessmann Heatpump (SG Ready)

<div className="device-detail-container">
  <div className="device-detail-content">
    <DeviceFeatures features="" />

One-time hot water preparation to a configurable target temperature. The device automatically decides whether to use the heat pump or the auxiliary electric heater (if available).


<DeviceConfig code={`chargers:
    - name: my_charger
      type: template
      template: viessmann
      user: # Username, Register at [app.developer.viessmann.com](https://app.developer.viessmann.com)
      password: # Password, For the configured Viessmann account.
      clientid: # Client ID, Configure at [app.developer.viessmann.com](https://app.developer.viessmann.com)
      gateway_serial: # Gateway Serial, VitoConnect serial number (VitoCare App -> Settings -> Communication module -> Serial number)
      installation_id: # Installation ID, Unfortunately you cannot simply lookup this number in the Viessmann app - instead you need to use the following commands on the command line... we're aware this is not for every user, but currently we don't have a better workflow...<br/>  Prerequisites: curl, jq, and the following parameters:  \`\`\` VIESSMANN_USER=<your-user> VIESSMANN_PASS=<your-password> VIESSMANN_CLIENT_ID=<your-clientid> \`\`\`  Then execute the following to get an oauth token (n.b. it's best to paste the entire block as-is, since the intermediate 'CODE' is only valid for 20 seconds):  \`\`\` VIESSMANN_REDIRECT_URI="http://localhost:4200/" VIESSMANN_CODE_CHALLENGE="5M5nhkBfkWZCGfLZYcTL-l7esjPUN7PpZ4rq8k4cmys" VIESSMANN_CODE_VERIFIER="6PygdmeK8JKPuuftlkc6q4ceyvjhMM_a_cJrPbcmcLc-SPjx2ZXTYr-SOofPUBydQ3McNYRy7Hibc2L2WtVLJFpOQ~Qbgic455ArKjUz9_UiTLnO6q8A3e.I_fIF8hAo"  VIESSMANN_CODE=$(curl -X POST --silent \   --user $VIESSMANN_USER:$VIESSMANN_PASS \   --output /dev/null \   --dump-header -    \   "https://iam.viessmann.com/idp/v3/authorize?client_id=$VIESSMANN_CLIENT_ID&redirect_uri=$VIESSMANN_REDIRECT_URI&scope=IoT%20User%20offline_access&response_type=code&code_challenge=$VIESSMANN_CODE_CHALLENGE&code_challenge_method=S256" \   | grep "^location: "            \   | sed 's/.*\\?code=\\(.*\\).*/\\1/' \   | tr -d '[:space:]')  TOKEN_RESPONSE=$(curl -XPOST --silent \   -H "Content-Type: application/x-www-form-urlencoded" \   --data "grant_type=authorization_code&client_id=$VIESSMANN_CLIENT_ID&redirect_uri=$VIESSMANN_REDIRECT_URI&code_verifier=$VIESSMANN_CODE_VERIFIER&code=$VIESSMANN_CODE" \   https://iam.viessmann.com/idp/v3/token)  VIESSMANN_TOKEN=$(echo $TOKEN_RESPONSE | jq --raw-output .access_token) \`\`\`  Finally, get the installation id:  \`\`\` curl --silent -H "Authorization: Bearer $VIESSMANN_TOKEN" \   https://api.viessmann.com/iot/v1/equipment/installations?includeGateways=true \   | jq '.data[].id' \`\`\`
      device_id: 0 # Device ID, typically \`0\`
      target_temperature: 45 # Target temperature for one-time charge (째C), max. 60째C`}  />
  </div>
  <div className="device-detail-icon">
    <evcc-icon
      type="charger"
      name="viessmann-heatpump-sg-ready"
      size="400px"
      alt="Viessmann Heatpump (SG Ready)"
      className="device-detail-icon-img"
    ></evcc-icon>
  </div>
</div>

## Template Parameter `viessmann`

| Name | Explanation | Value | Optional |
|-----------|-------------|-------|----------|
| Username<br/>`user` | Register at \[app.developer.viessmann.com\](https://app.developer.viessmann.com) |  | yes |
| Password<br/>`password` | For the configured Viessmann account. |  | yes |
| Client ID<br/>`clientid` | Configure at \[app.developer.viessmann.com\](https://app.developer.viessmann.com) |  | yes |
| Gateway Serial<br/>`gateway_serial` | VitoConnect serial number (VitoCare App -> Settings -> Communication module -> Serial number) |  | yes |
| Installation ID<br/>`installation_id` | Unfortunately you cannot simply lookup this number in the Viessmann app - instead you need to use the following commands on the command line... we're aware this is not for every user, but currently we don't have a better workflow...<br/>  Prerequisites: curl, jq, and the following parameters:  ``` VIESSMANN_USER=<your-user> VIESSMANN_PASS=<your-password> VIESSMANN_CLIENT_ID=<your-clientid> ```  Then execute the following to get an oauth token (n.b. it's best to paste the entire block as-is, since the intermediate 'CODE' is only valid for 20 seconds):  ``` VIESSMANN_REDIRECT_URI="http://localhost:4200/" VIESSMANN_CODE_CHALLENGE="5M5nhkBfkWZCGfLZYcTL-l7esjPUN7PpZ4rq8k4cmys" VIESSMANN_CODE_VERIFIER="6PygdmeK8JKPuuftlkc6q4ceyvjhMM_a_cJrPbcmcLc-SPjx2ZXTYr-SOofPUBydQ3McNYRy7Hibc2L2WtVLJFpOQ~Qbgic455ArKjUz9_UiTLnO6q8A3e.I_fIF8hAo"  VIESSMANN_CODE=$(curl -X POST --silent \   --user $VIESSMANN_USER:$VIESSMANN_PASS \   --output /dev/null \   --dump-header -    \   "https://iam.viessmann.com/idp/v3/authorize?client_id=$VIESSMANN_CLIENT_ID&redirect_uri=$VIESSMANN_REDIRECT_URI&scope=IoT%20User%20offline_access&response_type=code&code_challenge=$VIESSMANN_CODE_CHALLENGE&code_challenge_method=S256" \   \| grep "^location: "            \   \| sed 's/.*\?code=\(.*\).*/\1/' \   \| tr -d '\[:space:\]')  TOKEN_RESPONSE=$(curl -XPOST --silent \   -H "Content-Type: application/x-www-form-urlencoded" \   --data "grant_type=authorization_code&client_id=$VIESSMANN_CLIENT_ID&redirect_uri=$VIESSMANN_REDIRECT_URI&code_verifier=$VIESSMANN_CODE_VERIFIER&code=$VIESSMANN_CODE" \   https://iam.viessmann.com/idp/v3/token)  VIESSMANN_TOKEN=$(echo $TOKEN_RESPONSE \| jq --raw-output .access_token) ```  Finally, get the installation id:  ``` curl --silent -H "Authorization: Bearer $VIESSMANN_TOKEN" \   https://api.viessmann.com/iot/v1/equipment/installations?includeGateways=true \   \| jq '.data\[\].id' ``` |  | yes |
| Device ID<br/>`device_id` | typically `0` |  | yes |
| Target temperature for one-time charge<br/>`target_temperature` | max. 60째C | Standard: `45`<br/>Einheit: 째C | yes |

