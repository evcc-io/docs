---
sidebar_position: 2
---

# Konfiguration

## Einrichtung und Konfiguration

### Hinweis zur Individualisierung

:::caution

In evcc sind sehr viele individuelle Einstellungen m√∂glich. Die Default-Einstellungen der Parameter beruhen auf Erfahrungswerten und im Allgemeinen sind keine √Ñnderungen notwendig.

**Bei Individualisierung, bitte folgendes beachten:**

- **Da sich die Parameter teilweise gegenseitig beeinflussen, wird dringend empfohlen, √Ñnderungen an diesen Einstellungen nur einzeln vorzunehmen und die Auswirkungen zu testen, bevor weitere √Ñnderungen vorgenommen werden.**

:::

### Sponsoring

:::info

Dadurch, dass Github die Bezahlm√∂glichkeiten f√ºr das Sponsoring ge√§ndert hat, ist leider kein Paypal mehr m√∂glich.

Wer keine Kredit-/Debitkarte verwenden m√∂chte, kann sich diesbez√ºglich per Mail an info@evcc.io wenden.

:::

### Syntax-Fehler in der evcc.yaml finden

yaml ist sehr syntax-empfindlich. Fehler fallen nicht immer sofort ins Auge.

Eine schnelle Hilfe bieten yaml-Tester wie z.B. (https://onlineyamltools.com/validate-yaml)

### Etwas funktioniert nicht. Was nun?

Bei evcc gibt es einen [Community Support](https://github.com/evcc-io/evcc/discussions). Hier helfen sowohl Entwickler als auch Anwender bei verschiedenen Problemen. Es w√§re gut, dabei m√∂glichst genaue Informationen zu folgenden Bereichen mitzuteilen:

- Welche Ger√§te (Fahrzeug, Hausinstallation, Wallbox) verwendet werden.

- Die Konfigurationsdatei `evcc.yaml`,

<details>
<summary>
  d.h. deren Inhalt (*bitte Benutzernamen, Passw√∂rter und √§hnliches entfernen*).
</summary>

`egrep -v '^#|^\s+#' evcc.yaml |grep . |sed -E 's/(password|user|token|url|host|broker).*/\1: *****/'`

</details>

- alternativ kann mit `evcc dump --cfg >~/config.txt` eine anonymisierte Konfigurationsdatei erstellt und unter dem angegebenen Namen im Home-Verzeichnis gespeichert werden.

- Eine m√∂glichst genaue Beschreibung was das Problem ist.

**Erste Hilfe**

Zur Erleichterung wurde eine Erste-Hilfe Funktionalit√§t entwickelt. Durch Eingabe von `evcc discuss` auf der Kommandozeile wird ein neuer Diskussionsbeitrag in der Rubrik "Erste Hilfe" erstellt. Dieser Beitrag beinhaltet automatisch die Fehlermeldung(en) und die anonymisierte Konfigurationsdatei. Erg√§nzt werden muss nur noch ein aussagekr√§ftiger Titel und eine Problembeschreibung.
Diese Erste-Hilfe ist jeweils nur f√ºr die Erst-Erstellung eines Diskussionsbeitrages nutzbar. Sind im Zuge der L√∂sungsfindung weitere Informationen notwendig, m√ºssen diese h√§ndisch erstellt werden.

Wir versuchen nat√ºrlich Probleme so gut es geht zu vermeiden, aber das kann aufgrund der Komplexit√§t leider nicht immer gelingen.

### Wie kann ich ein Logfile zur Fehleranalyse erstellen?

evcc gibt in seiner Standard Konfiguration nur dann Fehlermeldungen aus, wenn ein Fehler auftritt (siehe auch [`log`](/docs/reference/configuration/log#log) Parameter in der `evcc.yaml`).

Wenn evcc auf der Konsole ausgef√ºhrt wird, werden die `log` Nachrichten einfach in die normale Ausgabe geleitet.

Mittels `evcc charger` oder `evcc meter` oder `evcc vehicle` k√∂nnen auf der Kommandozeile die verschiedenen Ger√§tetypen getestet werden. Dabei kommt der in `evcc.yaml` konfigurierte Log-Parameter (siehe oben) zum Einsatz. Will man davon abweichende Tests durchf√ºhren, kann der Log-Parameter beim Aufruf entsprechend erg√§nzt werden.

`Beispiel: evcc -l debug meter`

Wird evcc als Linux Systemdienst, wie [hier beschrieben](/docs/installation/manual#evcc-als-service), ausgef√ºhrt, k√∂nnen die log-Nachrichten √ºber folgende Befehle verfolgt, bzw. aufgelistet werden:

- Kontinuierliche Anzeige der evcc log Meldungen  
  `sudo journalctl -fau evcc`
- Anzeige der evcc log Meldungen seit dem letzten Start des evcc Services (Abbruch mit Strg-c)  
  `sudo journalctl -u evcc -q`
- Speichern der Log-Ausgabe in eine Datei im Home-Verzeichnis  
  `sudo journalctl -u evcc -q > ~/evcc.log`
- Erg√§nzend kann auch noch Start- (`-S`) und Endzeitpunkt (`-U`) der Log-Ausgabe bestimmt werden  
  `sudo journalctl -u evcc -S "2023-03-21 07:00:00" -U "2023-03-21 08:00:00" -q > ~/evcc.log`

Weiterf√ºhrende Hilfe: [wiki.ubuntuusers.de/systemd/journalctl](https://wiki.ubuntuusers.de/systemd/journalctl/)

Im Falle einer Docker Installation kann man √ºber `docker logs` die Nachrichten anzeigen lassen, siehe [Docker Dokumentation](https://docs.docker.com/config/containers/logging/).

### Weiterf√ºhrende Hilfe bei der Ger√§teerkennung

`evcc detect` ist ein spezielles Kommando, welches eine Art Hardwareerkennung und Netzwerksuche f√ºr bestimmte Ger√§te erm√∂glicht.
Insbesondere hilft es manchmal bei der ersten Einsch√§tzung von "neuen" SunSpec-kompatiblen Modbus-Ger√§ten und bei der Validierung von IP-Konfigurationen.
Es ist aber mehr ein Entwickler- und Supporttool zu Diagnosezwecken und erkennt auch nur einen nicht n√§her definierbaren Ger√§tetypenkreis.

### Fehler: evcc UI ist nicht erreichbar (Demo Modus funktioniert aber)

Es kommt immer wieder vor, dass Fehler in der Konfiguration √ºbersehen werden und der Service gestartet wird. Dabei wird der Start von evcc abgebrochen, ohne das es daf√ºr einen Hinweis gibt. Ergebnis ist, dass das UI nicht erreichbar ist.

In dem Fall sollte man evcc durch Eingabe von `evcc` auf der Kommandozeile starten. Dort werden dann auch Fehlerhinweise gegeben, die den Start des Service verhindert haben.

Mittels der oben genannten Tests kann man diesen Fehlern auf den Grund gehen und sie beheben. Erst wenn alles fehlerfrei ist, sollte der Service gestartet werden.

### Fehler: `connection refused`

Die IP-Verbindung zum betreffenden Ger√§t ist prinzipiell vorhanden, jedoch wird der Verbindungsaufbau von diesem Ger√§t zum angegebenen Port abgewiesen.

Die Gr√ºnde daf√ºr k√∂nnen vielf√§ltig sein. Typisch sind:

- Der am Ger√§t offene Port stimmt nicht mit dem in der evcc-Konfiguration angegebenen Zielport √ºberein.
- Der externe Zugriff auf das Ger√§t ist nicht aktiviert (z.B. bei Solaredge-Wechselrichtern im Auslieferungszustand).
- Die maximal m√∂gliche Anzahl an parallelen Verbindungen, die das Zielger√§t verwalten kann, ist ersch√∂pft. Andere Verbindungen z. B. von Hausautomationen, Skripten oder weiteren Instanzen von evcc m√ºssen ggf. zun√§chst beendet werden, bevor eine neue Verbindung m√∂glich ist. Im ung√ºnstigsten Fall l√§sst das Zielsystem nur eine einzige Verbindung zu.
- Blockade durch eine Firewall.

### Fehler: `i/o timeout`

Hier ist eine Verbindung zum Ger√§t ggf. vorhanden, jedoch antwortet das Zielsystem nicht innerhalb der vorgesehenen Zeit. Entweder kommt die Anfrage gar nicht beim Zielsystem an, geht auf dem R√ºckweg verloren oder die Antwort dauert zu lange.

Typische Gr√ºnde sind:

- Langsame oder schlechte Netzwerkverbindung (insbesondere bei Verbindungen √ºber WiFi oder PowerLAN)
- Fehlerhafte oder ungeeignete Verkabelung oder (bei RS485) falsche Terminierung
- Das Zielger√§t ist √ºberlastet oder ausgefallen
- Bestimmte Funktionen des Ger√§ts sind nicht wie von evcc erwartet verf√ºgbar (z. B. durch veraltete Firmware oder abweichende Konfigurationseinstellungen)
- Zu kurze Timeout- oder Abfragezykluszeiten seitens evcc

### Fehler: `/tmp/evcc: operation not permitted` oder/und `bind: address already in use`

Diese Fehlermeldung erscheint, wenn z B. evcc bereits als Dienst l√§uft und evcc zus√§tzlich ein weiteres mal auf der Kommandozeile (durch Eingabe `evcc`) gestartet wird, ggf. auch noch mit unterschiedlichen Benutzerberechtigungen. Es darf immer nur eine einzige Instanz von evcc zur gleichen Zeit laufen.

Eine Pr√ºfung, ob mehrere evcc Prozesse laufen, kann unter Linux mit Hilfe von `htop` erfolgen.

Sollte es Gr√ºnde geben, evcc auf der Kommandoebene zu starten, sollte vorher der Dienst mit `sudo systemctl stop evcc` beendet werden.

### Telemetry & Community Daten

Auf der [evcc Webseite](https://evcc.io/#live) und im "Auswertung Ladeenergie" Dialog der evcc-UI zeigen wir aggregierte Live-Ladedaten der evcc-Installationen an. Wir sammeln diese Daten auf unserer zentralen api.evcc.io Instanz. Die Teilnahme daran ist selbstverst√§ndlich freiwillig.

**Wie kann ich teilnehmen?**

Im "Auswertung Ladeenergie" Dialog kannst du unter "Live-Community" deine Daten teilen. Bislang konnte die Funktion auch √ºber [`telemetry: true`](/docs/reference/configuration/telemetry/) aktiviert werden. Dieser Weg ist nun allerdings veraltet ("deprecated").

F√ºr die Teilnahme ist aktuell ein üíö Sponsor Token erforderlich. Der Hauptgrund daf√ºr ist die Datenqualit√§t hoch zu halten und Fake-Daten zu minimieren.

**Was wird aktuell √ºbertragen?**

- aktuelle Ladeleistung
- aktueller Anteil an Sonnenstrom
- geladene Energiemenge
- geladener Anteil an Sonnenenergie

M√∂glicherweise werden wir zuk√ºnftig noch weitere Daten hinzuf√ºgen. Dies werden aber auf keinen Fall personenbezogene Daten oder private Installationsdaten (Adresse, Zug√§nge) sein. Eure Privatsph√§re ist uns wichtig!

**Was passiert mit den Daten?**

Wir speichern die Energiemengen aggregiert pro evcc-Instanz. Wir bilden keine Nutzerprofile √ºber Zeit und haben auch kein Interesse daran dies zuk√ºnftig zu tun.

Unser Ziel ist es durch diese Daten mehr neue Nutzer f√ºr evcc zu begeistern, selbst mehr √ºber das Nutzungsverhalten von evcc zu erfahren und vor allem das durch evcc nutzbar gemachte Potenzial regenerativer Sonnenenergie zu visualisieren.

Die dargestellten aggregierten Gesamtdaten k√∂nnen auch frei √ºber https://api.evcc.io/v1/total abgerufen werden. Wenn ihr also Ideen f√ºr eigene kreative Visualisierungen habt, baut gerne was und erz√§hlt uns davon.

Mehr Informationen findest du auch auf unserer [Datenschutzseite](https://sponsor.evcc.io/privacy).

### Ersparnisberechnung

In der evcc Oberfl√§che wird dir unten rechts angezeigt wieviel Prozent deiner geladenen Energie aus eigenem Sonnenstrom stammt (Beispiel: **85% Sonnenenergie**).
Beim Klick darauf √∂ffnet sich ein Dialog der mehr Details zur Ladenergie und deinen eingesparten Kosten zeigt.
Damit diese Werte korrekt sind, musst du deinen Energie- und Einspeisepreis in der Konfiguration hinterlegen.
Hier ein Beispiel:

**Beispiel**:

```yaml
tariffs:
  currency: EUR # (default EUR)
  grid:
    type: fixed
    price: 0.294 # [currency]/kWh

  feedin:
    type: fixed
    price: 0.08 # [currency]/kWh
```

Mehr Details zur Konfiguration findest du in [`tariffs`](/docs/reference/configuration/tariffs).

F√ºr die Berechnung der Einsparungen erfasst evcc grob die Gesamtmenge der geladenen Energie und die verwendeten Energiequellen (Netz, Batterie, PV).

**Was ist Sonnenenergie?**

Die direkte PV-Nutzung und die vom Batteriesystem bereitgestellte Energie werden bei dieser Berechnung gleich behandelt.
evcc geht davon aus, dass der Hausspeicher prim√§r zur Speicherung von √ºbersch√ºssigem, selbstproduzierten Sonnenstrom verwendet wird.
Erf√ºllt der Speicher auch netzdienliche Leistungen (bspw. Sonnen) oder f√ºhrt eine Kalibrierung mit Netzstrom durch, ist diese Annahme nicht immer korrekt.
Batterieverluste durch die Umwandlung werden nicht ber√ºcksichtigt.

**Berechnung von Ersparnis und effektivem Energiepreis**

Der Algorithmus unterscheidet zwischen Netzstrom und selbst erzeugter Sonnenenergie (PV, Batterie).
Der Kostenvorteil deiner Sonnenenergie ergibt sich aus der Differenz zwischen deinem Netzbezugspreis (z.B. 30 ct/kWh) und deinem Einspeisetarif (z.B. 8 ct/kWh).
Jede geladene kWh selbst produzierter Energie ist in diesem Beispiel 22 ct (30 ct - 8 ct) g√ºnstiger als der Netzbezug.
Hast du 2 kWh eigene Energie geladen entspricht das einer **Ersparnis** von 44 ct.

W√ºrdest du dein Auto zu 100% mit eigener Sonnenenergie laden, entspricht der angezeigte **effektive Energiepreis** deiner, nicht eingenommenen, Einspeiseverg√ºtung (bspw. 8 ct/kWh).
L√§dst du dein Auto zu 50% aus Sonnenenergie und zu 50% aus Netzstrom passt sich der Energiepreis entsprechend an (bspw. 19 ct/kWh).

Wenn du keine Einspeiseverg√ºtung erh√§ltst, kannst du den Einspeisepreis auf 0 setzen.
Die Sonnenenergie wird dann als kostenlos gerechnet.

Uns ist klar, dass diese Einsparung nicht allein evcc zuzuschreiben ist.
Steckst du dein Auto an einem sonnigen Tag an eine _dumme_ Wallbox, wird ein Teil der geladenen Energie auch Sonnenstrom sein.
evcc hilft dir aber den Anteil der geladenen Sonnenenergie zu maximieren.

**Berechnung des Sonnenenergieanteils**

Wenn du gleichzeitig Energie aus verschiedenen Quellen beziehst (z.B. 50% PV, 50% Netzbezug), wird die selbst erzeugte Energie zuerst dem Haus, also allen nicht von evcc gesteuerten Verbrauchern, zugeordnet.
Der verbleibende Anteil wird dann auf die Ladevorg√§nge aufgeteilt.
Beispiel: Deine PV-Anlage erzeugt 3 kW. Diese 3 kW werden komplett vom Haus verbraucht (bspw. Waschmaschine).
Parallel l√§dst du dein Auto mit 3 kW (bspw. Modus = schnell).
Das Haus wird in diesem Fall mit 100% Sonnenanteil gerechnet, das Auto mit 0%.

Flexible Preise (Octopus Energy, Awattar, Tibber, etc) werden f√ºr die Ermittlung des effektiven Energiepreises ber√ºcksichtigt.
