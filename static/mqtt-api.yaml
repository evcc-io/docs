asyncapi: 3.0.0
info:
  title: evcc MQTT-API
  version: latest
operations:
  LoadpointBatteryBoostSet:
    description: >-
      Enables or disables battery boost. [Read
      more.](/en/docs/features/battery#battery-boost)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/batteryBoost/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        batteryBoost:
          $ref: "#/components/messages/batteryBoost"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointChargeVehicleNameSet:
    description: >-
      Changes the association of a vehicle to the loadpoint. [Read
      more.](/en/docs/features/vehicle)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/vehicle/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        vehicleName:
          description: >-
            Vehicle name. [See
            documentation](/en/docs/reference/configuration/vehicles#name)
          payload:
            type: string
            examples:
              - Cupra Born
              - "-"
              - nil
              - "null"
              - none
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointDisableDelaySet:
    description: >-
      Specifies the delay before charging stops in solar mode. [Read
      more.](/en/docs/reference/configuration/loadpoints)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/disableDelay/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        disableDelay:
          $ref: "#/components/messages/disableDelay"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointDisableThresholdSet:
    description: >-
      Specifies the grid draw power to stop charging in solar mode. [Read
      more.](/en/docs/reference/configuration/loadpoints#threshold-1)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/disableThreshold/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        disableThreshold:
          $ref: "#/components/messages/disableThreshold"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointEnableDelaySet:
    description: >-
      Specifies the delay before charging starts in solar mode. [Read
      more.](/en/docs/reference/configuration/loadpoints#delay)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/enableDelay/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        enableDelay:
          $ref: "#/components/messages/enableDelay"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointEnableThresholdSet:
    description: >-
      Specifies the available surplus power to start charging in solar mode.
      [Read more.](/en/docs/reference/configuration/loadpoints#threshold)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/enableThreshold/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        enableThreshold:
          $ref: "#/components/messages/enableThreshold"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointLimitEnergySet:
    description: >-
      Updates the energy limit of the loadpoint. Only available for guest
      disconnect. [Read more.](/en/docs/features/limit)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/limitEnergy/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        limitEnergy:
          $ref: "#/components/messages/limitEnergy"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointMaxCurrentSet:
    description: Updates the maximum current of the loadpoint.
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/maxCurrent/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        maxCurrent:
          $ref: "#/components/messages/maxCurrent"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointMinCurrentSet:
    description: Updates the minimum current of the loadpoint.
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/minCurrent/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        minCurrent:
          $ref: "#/components/messages/minCurrent"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointModeSet:
    description: >-
      Changes the charging behavior of the loadpoint. [Read
      more.](/en/docs/features/solar-charging)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/mode/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        mode:
          $ref: "#/components/messages/mode"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointPhasesSet:
    description: >-
      Updates the allowed phases of the loadpoint. Selects the desired phase.
      [Read more.](/en/docs/reference/configuration/loadpoints#phases)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/phases/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        phases:
          $ref: "#/components/messages/loadpointPhases"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointPlanEnergySet:
    description: >-
      Creates a charging plan with fixed time and energy target. [Read
      more.](/en/docs/features/plans)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/planEnergy/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        planEnergy:
          description: Charging plan with fixed time and energy target.
          contentType: application/json
          payload:
            type: object
            properties:
              time:
                $ref: "#/components/messages/timestamp"
              precondition:
                $ref: "#/components/messages/precondition"
              value:
                description: Energy target in Wh
                type: number
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointPrioritySet:
    description: >-
      Sets the priority of the loadpoint. [Read
      more.](/en/docs/reference/configuration/loadpoints#priority)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/priority/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        priority:
          $ref: "#/components/messages/priority"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointSmartCostLimitSet:
    description: >-
      Sets the price or emission limit for fast-charging with grid energy. [Read
      more.](/en/docs/features/dynamic-prices)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/smartCostLimit/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        smartCostLimit:
          $ref: "#/components/messages/smartCostLimit"
    tags:
      - $ref: "#/components/tags/loadpoints"
  LoadpointVehicleLimitSocSet:
    description: >-
      Updates the SoC limit of the loadpoint. Requires a connected vehicle.
      [Read more.](/en/docs/features/limit)
    action: send
    channel:
      address: "{topic}/loadpoints/{id}/vehicleLimitSoc/set"
      parameters:
        id:
          $ref: "#/components/parameters/id"
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        vehicleLimitSoc:
          $ref: "#/components/messages/soc"
    tags:
      - $ref: "#/components/tags/loadpoints"
  SiteBatteryDischargeControlSet:
    description: >-
      Prevent home battery discharge during vehicle fast charging. [Read
      more.](/en/docs/features/battery)
    action: send
    channel:
      address: "{topic}/site/batteryDischargeControl/set"
      messages:
        batteryDischargeControl:
          $ref: "#/components/messages/batteryDischargeControl"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
    tags:
      - $ref: "#/components/tags/site"
  SiteBatteryGridChargeLimitSet:
    description: >-
      Charge home battery from grid when price or emissions are below the limit.
      [Read more.](/en/docs/features/battery)
    action: send
    channel:
      address: "{topic}/site/batteryGridChargeLimit/set"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        batteryGridChargeLimit:
          description: Battery grid charge limit in cost or emissions.
          payload:
            type: number
    tags:
      - $ref: "#/components/tags/site"
  SiteBatteryModeSet:
    description: >-
      Directly controls the mode of all controllable batteries. evcc behavior
      like "price limit" or "prevent discharge while fast charging" is
      overruled. External mode resets after 60s. The external system has to call
      this endpoint regularly.
    action: send
    channel:
      address: "{topic}/site/batteryMode/set"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        batteryMode:
          $ref: "#/components/messages/batteryMode"
    tags:
      - $ref: "#/components/tags/site"
  SiteBufferSocSet:
    description: Set battery buffer SoC. [Read more.](/en/docs/features/battery)
    action: send
    channel:
      address: "{topic}/site/bufferSoc/set"
      messages:
        bufferSoc:
          $ref: "#/components/messages/soc"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
    tags:
      - $ref: "#/components/tags/site"
  SiteBufferStartSocSet:
    description: Set battery buffer start SoC. [Read more.](/en/docs/features/battery)
    action: send
    channel:
      address: "{topic}/site/bufferStartSoc/set"
      messages:
        bufferStartSoc:
          $ref: "#/components/messages/soc"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
    tags:
      - $ref: "#/components/tags/site"
  SitePrioritySocSet:
    description: Set battery priority SoC. [Read more.](/en/docs/features/battery)
    action: send
    channel:
      address: "{topic}/site/prioritySoc/set"
      messages:
        prioritySoc:
          $ref: "#/components/messages/soc"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
    tags:
      - $ref: "#/components/tags/site"
  SiteResidualPowerSet:
    description: >-
      Sets target operating point of the control loop. [Read
      more.](/en/docs/reference/configuration/site#residualpower)
    action: send
    channel:
      address: "{topic}/site/residualPower/set"
      messages:
        residualPower:
          $ref: "#/components/messages/residualPower"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
    tags:
      - $ref: "#/components/tags/site"
  SiteSmartCostLimitSet:
    description: >-
      Sets the price or emission limit for fast-charging with grid energy. [Read
      more.](/en/docs/features/dynamic-prices)
    action: send
    channel:
      address: "{topic}/site/smartCostLimit/set"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
      messages:
        smartCostLimit:
          $ref: "#/components/messages/smartCostLimit"
    tags:
      - $ref: "#/components/tags/site"
  VehicleLimitSocSet:
    description: >-
      Charging will stop when this SoC is reached. [Read
      more.](/en/docs/features/limits)
    action: send
    channel:
      address: "{topic}/vehicles/{vehicleName}/limitSoc/set"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
        vehicleName:
          $ref: "#/components/parameters/vehicleName"
      messages:
        limitSoc:
          $ref: "#/components/messages/soc"
    tags:
      - $ref: "#/components/tags/vehicles"
  VehicleMinSocSet:
    description: >-
      Vehicle will be fast-charged until this SoC is reached. [Read
      more.](/en/docs/features/limits)
    action: send
    channel:
      address: "{topic}/vehicles/{vehicleName}/minSoc/set"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
        vehicleName:
          $ref: "#/components/parameters/vehicleName"
      messages:
        minSoc:
          $ref: "#/components/messages/soc"
    tags:
      - $ref: "#/components/tags/vehicles"
  VehiclePlanSet:
    description: >-
      Creates a charging plan with fixed time and SoC target. [Read
      more.](/en/docs/features/plans)
    action: send
    channel:
      address: "{topic}/vehicles/{vehicleName}/planSoc/set"
      parameters:
        topic:
          $ref: "#/components/parameters/topic"
        vehicleName:
          $ref: "#/components/parameters/vehicleName"
      messages:
        planSoc:
          description: Charging plan with fixed time and SoC target.
          payload:
            type: object
            properties:
              time:
                $ref: "#/components/messages/time"
              precondition:
                $ref: "#/components/messages/precondition"
              value:
                $ref: "#/components/messages/soc"
    tags:
      - $ref: "#/components/tags/vehicles"
components:
  messages:
    batteryBoost:
      description: >-
        Enables or disables battery boost. [Read
        more.](/en/docs/features/battery#battery-boost)
      payload:
        type: boolean
    batteryDischargeControl:
      description: >-
        Prevent home battery discharge during vehicle fast charging. [Read
        more.](/en/docs/features/battery)
      payload:
        type: boolean
    batteryMode:
      description: TODO
      payload:
        type: string
        enum:
          - unknown
          - normal
          - hold
          - charge
    disableDelay:
      description: >-
        Time in seconds. [Read
        more.](/en/docs/reference/configuration/loadpoints#delay)
      payload:
        type: integer
    disableThreshold:
      description: >-
        Specifies the grid draw power to stop charging in solar mode. [Read
        more.](/en/docs/reference/configuration/loadpoints#threshold-1)
      payload:
        type: number
    enableDelay:
      description: >-
        Time in seconds. [Read
        more.](/en/docs/reference/configuration/loadpoints#delay)
      payload:
        type: integer
    enableThreshold:
      description: >-
        Specifies the available surplus power to start charging in solar mode.
        [Read more.](/en/docs/reference/configuration/loadpoints#threshold)
      payload:
        type: number
    limitEnergy:
      description: >-
        Updates the energy limit of the loadpoint. Only available for guest
        disconnect. [Read more.](/en/docs/features/limit)
      payload:
        type: number
    loadpointPhases:
      description: >
        Number of phases. (0: auto, 1: 1-phase, 3: 3-phase) [Read
        more.](/en/docs/reference/configuration/loadpoints#phases)
      payload:
        type: integer
        enum:
          - "0"
          - "1"
          - "3"
    maxCurrent:
      description: Electric current in amps
      payload:
        type: number
    minCurrent:
      description: Electric current in amps
      payload:
        type: number
    mode:
      description: >-
        Charging mode. [Read
        more.](/en/docs/reference/configuration/loadpoints#mode)
      payload:
        type: string
        enum:
          - "off"
          - pv
          - minpv
          - now
    precondition:
      description: >-
        Late charging duration in seconds. [Read
        more.](/en/docs/features/plans#late-charging)
      payload:
        type: integer
        example: 3600
        minimum: 0
    priority:
      description: >-
        Sets the priority of the loadpoint. [Read
        more.](/en/docs/reference/configuration/loadpoints#priority)
      payload:
        type: integer
    residualPower:
      description: >-
        Sets target operating point of the control loop. [Read
        more.](/en/docs/reference/configuration/site#residualpower)
      payload:
        type: integer
    smartCostLimit:
      description: >-
        Sets the price or emission limit for fast-charging with grid energy.
        [Read more.](/en/docs/features/dynamic-prices)
      payload:
        type: number
    soc:
      description: SOC in %
      payload:
        type: number
        example: 60
        minimum: 0
        maximum: 100
    time:
      description: Time in RFC3339 format
      payload:
        type: string
        format: date-time
        example: "2025-07-19T12:30:00.000Z"
    timestamp:
      description: Timestamp in RFC3339 format
      payload:
        type: integer
        example: 1742104800
    vehicleName:
      description: "[See documentation](/en/docs/reference/configuration/vehicles#name)"
      payload:
        type: string
        minLength: 1
        pattern: "[a-zA-Z0-9_.:-]+"
        example: vehicle_1
  parameters:
    id:
      description: The index. Starts with 1.
      examples:
        - "1"
        - "2"
        - "3"
    topic:
      description: |
        MQTT topic for the message. Example: evcc
      examples:
        - evcc
    vehicleName:
      description: >-
        Vehicle name. [See
        documentation](/en/docs/reference/configuration/vehicles#name)
      examples:
        - db:19
        - vehicle_1
  tags:
    loadpoints:
      name: Loadpoints
    site:
      name: Site
    vehicles:
      name: Vehicles
