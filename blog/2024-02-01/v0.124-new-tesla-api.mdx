---
title: v0.124 - Neue Tesla Integration
authors: [naltatis]
tags: [release]
hide_table_of_contents: false
---

![Banner mit √úbersicht neuer Funktionen](v0.124-banner.webp)

Die Tage werden l√§nger und PV-√úberschussladen beginnt wieder Spa√ü zu machen.
Ein guter Zeitpunkt f√ºr ein kurzes Update √ºber die neuesten Entwicklungen bei evcc.

## Neue Tesla Integration

Im [Oktober](https://www.notateslaapp.com/news/1653/tesla-creates-official-apis-for-third-party-services-to-start-charging-for-usage) hat Tesla eine neue [offizielle API](https://developer.tesla.com/docs/fleet-api) vorgestellt.
Zudem wurde angek√ºndigt, dass die alte, [inoffizielle API](https://www.teslaapi.io) Anfang 2024 abgeschaltet wird.
In der vergangenen Woche hat Tesla mit dieser Abschaltung St√ºck f√ºr St√ºck begonnen.

### Was bedeutet das f√ºr mich?

Um die neue API nutzen zu k√∂nnen, musst du zwei Anpassungen in der `evcc.yaml` vornehmen:

1. **Neuer Template-Name:** Da die alte API f√ºr einige Nutzer heute noch funktioniert, haben wir uns entschieden vorerst beide Implementierungen parallel anzubieten. √Ñndere den Template-Namen von `tesla` zu `tesla-command`, um die neue API zu nutzen.

2. **Neue Tokens erzeugen:** Mit der neuen API ist es nun m√∂glich, die erforderlichen `accessToken` und `refreshToken` direkt im Browser zu erzeugen.
Daf√ºr haben wir unter [tesla.evcc.io](https://tesla.evcc.io) eine kleine Webseite bereitgestellt.
Ersetze die alten Tokens in der `evcc.yaml` mit den neu erzeugten.

Die Konfiguration sollte dann wie folgt aussehen:

```yaml
vehicles:
 - name: mytesla
   type: template
   template: tesla-command # change `tesla` to `tesla-command`
   accessToken: ... # generetad by tesla.evcc.io
   refreshToken:  ... # generetad by tesla.evcc.io
   ...
```

Die √ºber [tesla.evcc.io](https://tesla.evcc.io) erzeugten Token k√∂nnen **nur mit den offiziellen evcc Builds** (stable & nightly) verwendet werden.
Grund daf√ºr ist, dass die Tokens aus Teslas neuer Developer API immer an eine 3rd-Party App gebunden sind.

Du kannst dir evcc nat√ºrlich auch weiterhin selbst bauen.
Daf√ºr ben√∂tigst du aber einen eigenen Tesla Developer Account und musst die Tokens selbst erzeugen.
Mehr Details dazu findest du im entsprechenden [Pull Request](https://github.com/evcc-io/evcc/pull/10802).

### Privatsph√§re & Sicherheit

Wie auch bei der alten API l√§uft die Kommunikation f√ºr Datenabfrage (Ladestand, Zustand, ...) und Steuerung (Aufwecken) direkt zwischen deiner lokalen evcc Instanz und der Tesla-Infrastruktur ab.
Lediglich die Token-Erzeugung l√§uft einmalig √ºber unsere Webseite.
Tokens werden dabei nicht gespeichert, sondern nur im Browser angezeigt.

F√ºr eine erweiterte Steuerung des Fahrzeuges (Ladevorgang direkt am Fahrzeug starten und stoppen) ist eine zus√§tzlich signierte Anfrage an Tesla erforderlich.
Dies betrifft heute konkret die Nutzer eines Tesla Wall Connectors.
Da wir unseren privaten 3rd-Party-App-Schl√ºssel nicht ins evcc Binary packen k√∂nnen bzw. d√ºrfen, werden wir f√ºr diese Anwendung vermutlich einen [eigenen Service](https://github.com/evcc-io/evcc/pull/11893) bereitstellen, der diese Anfragen signiert und an Tesla weiterleitet.
Dazu aber mehr in einem sp√§teren Release.

### Kosten

Tesla bietet die neue API [aktuell noch kostenlos an](https://developer.tesla.com/docs/fleet-api#membership-tiers).
Allerdings haben sie bereits angek√ºndigt, dass sie in Zukunft f√ºr die Nutzung der API Geb√ºhren erheben werden.
Wie Open-Source-freundlich dieses Modell ausf√§llt, wissen wir bisher nicht.

Daher ist es durchaus m√∂glich, dass wir die Token-Bereitstellung in Zukunft nicht mehr kostenlos anbieten k√∂nnen.
Ggf. werden wir es mit dem existierenden evcc Sponsoring Modell verkn√ºpfen.
Aber mehr dazu, wenn es neue Informationen von Tesla gibt.

## Aktive Batteriesteuerung

Ein gro√ües neues Feature, was mit dem Weihnachts-Release Einzug gehalten hat, ist die aktive Batteriesteuerung.
Diese Funktion ist inzwischen nicht mehr als experimentell markiert.
Zudem sind in den vergangenen Wochen einige neue unterst√ºtzte Batterie-Wechselrichter hinzugekommen.
In der Dokumentation siehst du inzwischen auch, [ob dein Wechselrichter unterst√ºtzt wird](/docs/devices/meters#features).

### Passive Steuerung

Eine passive Batteriesteuerung bringt evcc schon seit einiger Zeit mit.
Hierbei regelt evcc das PV-√úberschussladen so, dass die Hausbatterie nicht ungewollt mit entladen wird.
Im letzten Jahr haben wir einen [Konfigurationsdialog](/blog/2023/10/05/feature-highlights-10-2023#batterieeinstellungen) eingef√ºhrt, mit dem die Priorisierung zwischen Fahrzeug- und Hausbatterieladung eingestellt werden kann.
Dieses Modell funktioniert beim reinen √úberschussladen auch sehr gut.
evcc kennt dabei lediglich den aktuellen Ladezustand der Hausbatterie und regelt nur die Ladeleistung des Fahrzeuges.
Dieser Mechanismus funktioniert allerdings nicht beim Schnellladen.
Hierf√ºr ist eine aktive Batteriesteuerung erforderlich.

### Entladesperre beim Schnellladen

Standardm√§√üig probiert die Hausbatterie den gesamten Energieverbrauch des Hauses (inkl. Ladestationen) zu decken.
Abh√§ngig vom aktuellen Strompreis oder erwarteter PV-Erzeugung kann es aber w√ºnschenswert sein, die Energie beim **schnellen Fahrzeugladen** direkt aus dem Netz und nicht aus der Hausbatterie zu beziehen.
Damit bleibt die gesammelte Sonnenenergie in der Hausbatterie und kann bspw. nachts f√ºr den Hausverbrauch genutzt werden.

Dies ist unser erster Anwendungsfall f√ºr die aktive Batteriesteuerung.
Unterst√ºtzt dein Wechselrichter dieses Feature, erscheint im Batterieeinstellungen Dialog eine entsprechende Option.

![Batteriesteuerung: Verhindere Entladung im Schnell-Modus und bei geplantem Laden.](batterycontrol-de.webp)

Ist diese Option aktiv, wird die Hausbatterie beim Schnellladen in einen Sperrmodus versetzt.
In dieser Zeit wird er weder entladen noch geladen.
Diese Sperre ist auch bei [geplantem Laden](/blog/2023/10/05/feature-highlights-10-2023#visualisierung-ladeplanung) und beim [smarten Netzladen](/blog/2023/10/05/feature-highlights-10-2023#smartes-netzladen) aktiv.

### N√§chster Schritt: Batterie mit g√ºnstigem Netzstrom laden

Die n√§chste Ausbaustufe f√ºr die aktive Batteriesteuerung ist die M√∂glichkeit, die Hausbatterie mit g√ºnstigem Netzstrom zu laden.
Das ist vor allem f√ºr Nutzer von dynamischen Stromtarifen an dunkleren Tagen interessant.
Ziel ist es dabei, die Hausbatterie in Niedrigpreisphasen mit Energie aus dem Netz zu f√ºllen und diese Energie dann in Hochpreisphasen zu nutzen.
Die erforderlichen Hardwareintegrationen haben wir bereits umgesetzt.
Daher rechnen wir damit, dass diese Funktion in einem der n√§chsten Releases verf√ºgbar sein wird.

## Update: Migration zur Browser-Konfiguration

evcc ist ein sehr flexibles und m√§chtiges System f√ºr die eigene Energieoptimierung.
Unsere gr√∂√üte Herausforderung ist es weiterhin, diese Flexibilit√§t mit einer einfachen Einrichtung zu vereinen.
In den letzten Monaten haben wir gro√üe Fortschritte im Bereich der Konfiguration gemacht.
Unser Ziel ist es eine reine browserbasierte Inbetriebnahme, ohne `evcc.yaml`, zu erm√∂glichen.

Hast du im Einstellungsdialog die Option "Experimentelle UI-Funktionen zeigen" aktiviert, kannst du unter "üß™ Device Configuration" unseren aktuellen Entwicklungsfortschritt sehen.
Aktuell k√∂nnen dort Fahrzeuge, Netzz√§hler, PV- und Batteriesysteme hinzugef√ºgt und bearbeitet werden.
Ladepunkte und Tarife folgen in der n√§chsten Iteration.
Auch wenn das Ganze noch ein "Work in Progress" ist, freuen wir uns √ºber dein Feedback.

![Device configuration](config-ui.webp)

## Kleine Verbesserungen und Fehlerbehebungen

Wie immer enth√§lt dieses Release auch eine Reihe kleinerer Verbesserungen und Fehlerbehebungen.
F√ºr mehr Details schau dir die [Release Notes](https://github.com/evcc-io/evcc/releases/tag/0.123.0) an.

Viele Gr√º√üe<br/>
euer evcc Core-Team