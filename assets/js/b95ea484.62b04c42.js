"use strict";(self.webpackChunkevcc_docs=self.webpackChunkevcc_docs||[]).push([[3488],{3564:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>t,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});var s=n(5893),l=n(1151);const c={sidebar_position:5},d="API",r={id:"reference/api",title:"API",description:"Mit evcc kann \xfcber REST und MQTT APIs interagiert werden.",source:"@site/docs/reference/api.md",sourceDirName:"reference",slug:"/reference/api",permalink:"/docs/reference/api",draft:!1,unlisted:!1,editUrl:"https://github.com/evcc-io/docs/tree/main/docs/reference/api.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Modbus",permalink:"/docs/reference/modbus"},next:{title:"Sponsorship",permalink:"/docs/sponsorship"}},t={},o=[{value:"REST API",id:"rest-api",level:2},{value:"Site",id:"site",level:3},{value:"Vehicles",id:"vehicles",level:3},{value:"Loadpoints",id:"loadpoints",level:3},{value:"MQTT API",id:"mqtt-api",level:2},{value:"Site",id:"site-1",level:3},{value:"Vehicles",id:"vehicles-1",level:3},{value:"Loadpoints",id:"loadpoints-1",level:3}];function a(e){const i={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",ul:"ul",...(0,l.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.h1,{id:"api",children:"API"}),"\n",(0,s.jsx)(i.p,{children:"Mit evcc kann \xfcber REST und MQTT APIs interagiert werden."}),"\n",(0,s.jsxs)(i.p,{children:["Alle API IDs (z.B. die Loadpoint ID) beginnen bei ",(0,s.jsx)(i.code,{children:"1"}),"."]}),"\n",(0,s.jsx)(i.h2,{id:"rest-api",children:"REST API"}),"\n",(0,s.jsx)(i.h3,{id:"site",children:"Site"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"GET /api/state"}),": evcc state (static configuration and dynamic state as JSON object)"]}),"\n",(0,s.jsxs)(i.li,{children:["(can also be used with filtering. e.g.: ",(0,s.jsx)(i.code,{children:'/api/state?jq=.statistics["30d"].avgPrice'}),")"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"GET /api/health"}),": evcc health check"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/prioritysoc/<soc>"}),": battery priority soc in %"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/buffersoc/<soc>"}),": battery buffer soc in %"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/bufferstartsoc/<soc>"}),": battery buffer start soc in %"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/residualpower/<power>"}),": grid residual power in W"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/batterydischargecontrol/<status>"}),": enable/disable battery discharge control (true/false)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/smartcostlimit/<cost>"}),': smart charging cost limit (previously known as "cheap" tariff)']}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"GET /api/tariff/<type>"}),": list of prices (grid/feedin/co2/planner)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"GET /api/sessions[?format=csv&lang=<lang>]"}),": charging sessions"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"GET /api/settings/telemetry"}),": telemetry enabled status"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/settings/telemetry/<status>"}),": enable/disable telemetry (true/false)"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"vehicles",children:"Vehicles"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Note"}),": for vehicle names see ",(0,s.jsx)(i.code,{children:"vehicles"})," array in ",(0,s.jsx)(i.code,{children:"/api/state"})," response."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/vehicles/<name>/minsoc/<soc>"}),": minimum soc in %"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/vehicles/<name>/limitsoc/<soc>"}),": limit soc in %"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/vehicles/<name>/plan/soc/<soc>/<time>"}),": soc in % / time in RFC3339 format **"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"DELETE /api/vehicles/<name>/plan/soc"}),": disable plan charging"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"loadpoints",children:"Loadpoints"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/mode/<mode>"}),": charge mode (off/pv/minpv/now)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/limitsoc/<soc>"}),": limit soc in % - only applicable for online vehicles"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/limitenergy/<energy>"}),": limit energy in kWh - only applicable for offline vehicles"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/plan/energy/<energy>/<time>"}),": energy in kWh / target time in RFC3339 format **"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"DELETE /api/loadpoints/<id>/plan/energy"}),": disable plan charging"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"GET /api/loadpoints/<id>/plan"}),": charging plan details"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/phases/<phases>"}),": allowed phases (0=auto/1=1p/3=3p)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/mincurrent/<current>"}),": current minCurrent value in A"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/maxcurrent/<current>"}),": current maxCurrent value in A"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/enable/threshold/<threshold>"}),": threshold value in W"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/disable/threshold/<threshold>"}),": threshold value in W"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"POST /api/loadpoints/<id>/vehicle/<name>"}),": set currently selected vehicle"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"DELETE /api/loadpoints/<id>/vehicle"}),": remove vehicle"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"PATCH /api/loadpoints/<id>/vehicle"}),": start vehicle detection"]}),"\n"]}),"\n",(0,s.jsx)(i.admonition,{type:"note",children:(0,s.jsxs)(i.p,{children:["Beispiel: ",(0,s.jsx)(i.code,{children:"curl -X POST http://evcc:7070/api/loadpoints/1/mode/pv"})," um den Lademodus des 1. Ladepunkts auf ",(0,s.jsx)(i.code,{children:"pv"})," zu stellen."]})}),"\n",(0,s.jsx)(i.h2,{id:"mqtt-api",children:"MQTT API"}),"\n",(0,s.jsxs)(i.p,{children:["Die MQTT API folgt der REST API Struktur. For writable APIs append ",(0,s.jsx)(i.code,{children:"/set"})," to the topic."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc"}),": root topic"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/status"}),": status (",(0,s.jsx)(i.code,{children:"online"}),"/",(0,s.jsx)(i.code,{children:"offline"}),")"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/updated"}),": timestamp of last update"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"site-1",children:"Site"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/site"}),": site dynamic state"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/site/prioritySoc"}),": battery priority SoC (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/site/bufferSoc"}),": battery buffer SoC (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/site/bufferStartSoc"}),": battery buffer start SoC (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/site/residualPower"}),": grid residual power (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/site/smartCostLimit"}),': smart charging cost limit (previously known as "cheap" tariff) (writable)']}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"vehicles-1",children:"Vehicles"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Note"}),": for vehicle names see ",(0,s.jsx)(i.code,{children:"evcc/vehicles"}),"."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/vehicles"}),": number of vehicles"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/vehicles/<name>/minSoc"}),": minimum soc in % (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/vehicles/<name>/limitSoc"}),": limit soc in % (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/vehicles/<name>/planSoc"}),": plan soc (writable using JSON payload: ",(0,s.jsx)(i.code,{children:'{"value": 50, "time": "2023-03-05T07:00:00Z"}'}),")"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"loadpoints-1",children:"Loadpoints"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints"}),": number of available loadpoints"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>"}),": dynamic state"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/mode"}),": charge mode (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/minSoc"}),": minimum SoC (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/limitSoc"}),": limit SoC in % (writable) - only applicable for online vehicles"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/limitEnergy"}),": limit energy in kWh (writable) - only applicable for offline vehicles"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/plan/energy"}),": plan energy (writable using JSON payload: ",(0,s.jsx)(i.code,{children:'{"value": 50, "time": "2023-03-05T07:00:00Z"}'}),")"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/phases"}),": enabled phases (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/minCurrent"}),": current minCurrent value (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/maxCurrent"}),": current maxCurrent value (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/enableThreshold"}),": threshold value (writable)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"evcc/loadpoints/<id>/disableThreshold"}),": threshold value (writable)"]}),"\n"]}),"\n",(0,s.jsx)(i.admonition,{type:"note",children:(0,s.jsxs)(i.p,{children:["Um schreibbare Einstellungen durchzuf\xfchren, muss ein ",(0,s.jsx)(i.code,{children:"/set"})," am Ende des Topics hinzugef\xfcgt werden an welches der neue Wert gesendet wird.\nBeispiel: ",(0,s.jsx)(i.code,{children:'mosquitto_pub -t "evcc/loadpoints/1/phases/set" -m "3"'})," um die Anzahl der netzseitigen Phasen am 1. Ladepunkt auf ",(0,s.jsx)(i.code,{children:"3"})," festzulegen."]})}),"\n",(0,s.jsxs)(i.admonition,{type:"info",children:[(0,s.jsxs)(i.p,{children:["** Zeitangabe efolgt in UTC im Format ",(0,s.jsx)(i.code,{children:"yyyy-mm-ddThh:mm:ssZ"})]}),(0,s.jsx)(i.p,{children:"Beispiele:"}),(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"2023-03-05T07:00:00Z"})," = 5. M\xe4rz 2023 um 8:00 Uhr MEZ"]}),(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.code,{children:"2023-08-17T19:30:00Z"})," = 17. August 2023 um 21:30 Uhr MESZ"]})]})]})}function h(e={}){const{wrapper:i}={...(0,l.a)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},1151:(e,i,n)=>{n.d(i,{Z:()=>r,a:()=>d});var s=n(7294);const l={},c=s.createContext(l);function d(e){const i=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),s.createElement(c.Provider,{value:i},e.children)}}}]);