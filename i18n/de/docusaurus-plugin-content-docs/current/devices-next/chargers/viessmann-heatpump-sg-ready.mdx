---
title: Viessmann Heatpump (SG Ready)
custom_edit_url: https://github.com/evcc-io/evcc/blob/master/templates/definition/charger/viessmann.yaml
hide_table_of_contents: true
---

import DeviceConfig from '@site/src/components/DeviceConfig';
import DeviceFeatures from '@site/src/components/DeviceFeatures';
import SponsorshipRequired from '/docs/_sponsorship_required.mdx';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Viessmann Heatpump (SG Ready)

<DeviceFeatures features="" />

Einmalige Warmwasserbereitung auf eine konfigurierbare Solltemperatur. Das Gerät entscheidet eigenständig, ob die Wärmepumpe oder die elektrische Zusatzheizung (falls vorhanden) genutzt wird.


<DeviceConfig code={`chargers:
    - name: my_charger
      type: template
      template: viessmann
      user: # Benutzerkonto, Registrieren auf [app.developer.viessmann.com](https://app.developer.viessmann.com)
      password: # Passwort, Für den konfigurierten Viessmann Account.
      clientid: # Client ID, Konfigurieren in [app.developer.viessmann.com](https://app.developer.viessmann.com)
      gateway_serial: # Gateway Serial, Seriennummer des VitoConnect modul (VitoCare App -> Einstellungen -> Kommunikationsmodul -> Seriennummer)
      installation_id: # Installation ID, Leider kann man die Installation ID nicht einfach in der Viessmann App einsehen - stattdessen müssen wir die folgenden Kommandos in der Kommandozeile ausführen. Es ist uns bewusst, dass das nicht für jeden Benutzer einfach umsetzbar ist, aber bisher haben wir leider keinen besseren Ablauf...<br/>  Vorraussetzungen: curl, jq, und die folgenden Umgebungsvariblen:  \`\`\` VIESSMANN_USER=<your-user> VIESSMANN_PASS=<your-password> VIESSMANN_CLIENT_ID=<your-clientid> \`\`\`  Dann holen wir uns einen oauth token (n.b. am besten den gesamten Block in das Terminal kopieren, da die Zwischenvariable 'CODE' nur 20 Sekunden gültig ist):  \`\`\` VIESSMANN_REDIRECT_URI="http://localhost:4200/" VIESSMANN_CODE_CHALLENGE="5M5nhkBfkWZCGfLZYcTL-l7esjPUN7PpZ4rq8k4cmys" VIESSMANN_CODE_VERIFIER="6PygdmeK8JKPuuftlkc6q4ceyvjhMM_a_cJrPbcmcLc-SPjx2ZXTYr-SOofPUBydQ3McNYRy7Hibc2L2WtVLJFpOQ~Qbgic455ArKjUz9_UiTLnO6q8A3e.I_fIF8hAo"  VIESSMANN_CODE=$(curl -X POST --silent \   --user $VIESSMANN_USER:$VIESSMANN_PASS \   --output /dev/null \   --dump-header -    \   "https://iam.viessmann.com/idp/v3/authorize?client_id=$VIESSMANN_CLIENT_ID&redirect_uri=$VIESSMANN_REDIRECT_URI&scope=IoT%20User%20offline_access&response_type=code&code_challenge=$VIESSMANN_CODE_CHALLENGE&code_challenge_method=S256" \   | grep "^location: "            \   | sed 's/.*\\?code=\\(.*\\).*/\\1/' \   | tr -d '[:space:]')  TOKEN_RESPONSE=$(curl -XPOST --silent \   -H "Content-Type: application/x-www-form-urlencoded" \   --data "grant_type=authorization_code&client_id=$VIESSMANN_CLIENT_ID&redirect_uri=$VIESSMANN_REDIRECT_URI&code_verifier=$VIESSMANN_CODE_VERIFIER&code=$VIESSMANN_CODE" \   https://iam.viessmann.com/idp/v3/token)  VIESSMANN_TOKEN=$(echo $TOKEN_RESPONSE | jq --raw-output .access_token) \`\`\`  Damit können wir jetzt die Installation ID abfragen:  \`\`\` curl --silent -H "Authorization: Bearer $VIESSMANN_TOKEN" \   https://api.viessmann.com/iot/v1/equipment/installations?includeGateways=true \   | jq '.data[].id' \`\`\`
      device_id: 0 # Device ID, normalerweise \`0\`
      target_temperature: 45 # Zieltemperatur für Einmal-Warmwasser-Zubereitung (°C), max. 60°C`}  />

## Templateparameter `viessmann`

| Name | Erklärung | Wert | Optional |
|-----------|-----------|------|----------|
| Benutzerkonto<br/>`user` | Registrieren auf \[app.developer.viessmann.com\](https://app.developer.viessmann.com) |  | ja |
| Passwort<br/>`password` | Für den konfigurierten Viessmann Account. |  | ja |
| Client ID<br/>`clientid` | Konfigurieren in \[app.developer.viessmann.com\](https://app.developer.viessmann.com) |  | ja |
| Gateway Serial<br/>`gateway_serial` | Seriennummer des VitoConnect modul (VitoCare App -&gt; Einstellungen -&gt; Kommunikationsmodul -&gt; Seriennummer) |  | ja |
| Installation ID<br/>`installation_id` | Leider kann man die Installation ID nicht einfach in der Viessmann App einsehen - stattdessen müssen wir die folgenden Kommandos in der Kommandozeile ausführen. Es ist uns bewusst, dass das nicht für jeden Benutzer einfach umsetzbar ist, aber bisher haben wir leider keinen besseren Ablauf...&lt;br/&gt;  Vorraussetzungen: curl, jq, und die folgenden Umgebungsvariblen:  ``` VIESSMANN_USER=&lt;your-user&gt; VIESSMANN_PASS=&lt;your-password&gt; VIESSMANN_CLIENT_ID=&lt;your-clientid&gt; ```  Dann holen wir uns einen oauth token (n.b. am besten den gesamten Block in das Terminal kopieren, da die Zwischenvariable 'CODE' nur 20 Sekunden gültig ist):  ``` VIESSMANN_REDIRECT_URI="http://localhost:4200/" VIESSMANN_CODE_CHALLENGE="5M5nhkBfkWZCGfLZYcTL-l7esjPUN7PpZ4rq8k4cmys" VIESSMANN_CODE_VERIFIER="6PygdmeK8JKPuuftlkc6q4ceyvjhMM_a_cJrPbcmcLc-SPjx2ZXTYr-SOofPUBydQ3McNYRy7Hibc2L2WtVLJFpOQ~Qbgic455ArKjUz9_UiTLnO6q8A3e.I_fIF8hAo"  VIESSMANN_CODE=$(curl -X POST --silent \   --user $VIESSMANN_USER:$VIESSMANN_PASS \   --output /dev/null \   --dump-header -    \   "https://iam.viessmann.com/idp/v3/authorize?client_id=$VIESSMANN_CLIENT_ID&redirect_uri=$VIESSMANN_REDIRECT_URI&scope=IoT%20User%20offline_access&response_type=code&code_challenge=$VIESSMANN_CODE_CHALLENGE&code_challenge_method=S256" \   \| grep "^location: "            \   \| sed 's/.*\?code=\(.*\).*/\1/' \   \| tr -d '\[:space:\]')  TOKEN_RESPONSE=$(curl -XPOST --silent \   -H "Content-Type: application/x-www-form-urlencoded" \   --data "grant_type=authorization_code&client_id=$VIESSMANN_CLIENT_ID&redirect_uri=$VIESSMANN_REDIRECT_URI&code_verifier=$VIESSMANN_CODE_VERIFIER&code=$VIESSMANN_CODE" \   https://iam.viessmann.com/idp/v3/token)  VIESSMANN_TOKEN=$(echo $TOKEN_RESPONSE \| jq --raw-output .access_token) ```  Damit können wir jetzt die Installation ID abfragen:  ``` curl --silent -H "Authorization: Bearer $VIESSMANN_TOKEN" \   https://api.viessmann.com/iot/v1/equipment/installations?includeGateways=true \   \| jq '.data\[\].id' ``` |  | ja |
| Device ID<br/>`device_id` | normalerweise `0` |  | ja |
| Zieltemperatur für Einmal-Warmwasser-Zubereitung<br/>`target_temperature` | max. 60°C | Standard: `45`<br/>Einheit: °C | ja |

